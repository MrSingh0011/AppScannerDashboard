(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{19650:(e,s,i)=>{"use strict";i.r(s),i.d(s,{default:()=>A});var l=i(95155),r=i(32521),n=i(88482),t=i(53999);function a(e){let{title:s,value:i,icon:r,trend:a,className:d}=e;return(0,l.jsx)(n.Zp,{className:(0,t.cn)("",d),children:(0,l.jsx)(n.Wu,{className:"p-6",children:(0,l.jsxs)("div",{className:"flex items-start justify-between",children:[(0,l.jsxs)("div",{className:"flex-1",children:[(0,l.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:s}),(0,l.jsx)("p",{className:"mt-2 text-3xl font-bold",children:i}),a&&(0,l.jsxs)("p",{className:(0,t.cn)("mt-2 text-sm",a.isPositive?"text-green-500":"text-red-500"),children:[a.isPositive?"+":"",a.value,"% from last scan"]})]}),(0,l.jsx)("div",{className:"rounded-lg bg-primary/10 p-3",children:(0,l.jsx)(r,{className:"h-6 w-6 text-primary"})})]})})})}var d=i(14474),c=i(90170),o=i(18357),u=i(54811);function x(e){let{score:s}=e,i=s>=80?{label:"Critical",color:"#ef4444"}:s>=60?{label:"High",color:"#f97316"}:s>=40?{label:"Medium",color:"#eab308"}:{label:"Low",color:"#22c55e"},r=[{name:"Risk",value:s},{name:"Safe",value:100-s}];return(0,l.jsxs)(n.Zp,{children:[(0,l.jsx)(n.aR,{children:(0,l.jsx)(n.ZB,{children:"Risk Score"})}),(0,l.jsx)(n.Wu,{children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{className:"relative h-40 w-40",children:[(0,l.jsx)(d.u,{width:"100%",height:"100%",children:(0,l.jsx)(c.r,{children:(0,l.jsxs)(o.F,{data:r,cx:"50%",cy:"50%",startAngle:180,endAngle:0,innerRadius:50,outerRadius:70,dataKey:"value",stroke:"none",children:[(0,l.jsx)(u.f,{fill:i.color}),(0,l.jsx)(u.f,{fill:"hsl(var(--muted))"})]})})}),(0,l.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("div",{className:"text-3xl font-bold",children:s}),(0,l.jsx)("div",{className:"text-xs text-muted-foreground",children:"/ 100"})]})})]}),(0,l.jsx)("div",{className:"flex-1 pl-8",children:(0,l.jsxs)("div",{className:"space-y-3",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"text-sm font-medium text-muted-foreground",children:"Risk Level"}),(0,l.jsx)("div",{className:"text-2xl font-bold",style:{color:i.color},children:i.label})]}),(0,l.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsx)("span",{className:"text-muted-foreground",children:"Vulnerabilities"}),(0,l.jsx)("span",{className:"font-medium",children:"4 found"})]}),(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsx)("span",{className:"text-muted-foreground",children:"Dangerous Permissions"}),(0,l.jsx)("span",{className:"font-medium",children:"5 granted"})]}),(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsx)("span",{className:"text-muted-foreground",children:"Exported Components"}),(0,l.jsx)("span",{className:"font-medium",children:"3 exposed"})]})]})]})})]})})]})}var m=i(8401),h=i(96025),v=i(16238),j=i(27086),g=i(8941);function f(e){let{vulnerabilities:s}=e,i=s.reduce((e,s)=>(e[s.severity]=(e[s.severity]||0)+1,e),{}),r=[{name:"Critical",count:i.critical||0,fill:"#ef4444"},{name:"High",count:i.high||0,fill:"#f97316"},{name:"Medium",count:i.medium||0,fill:"#eab308"},{name:"Low",count:i.low||0,fill:"#22c55e"}];return(0,l.jsxs)(n.Zp,{children:[(0,l.jsx)(n.aR,{children:(0,l.jsx)(n.ZB,{children:"Vulnerabilities by Severity"})}),(0,l.jsx)(n.Wu,{children:(0,l.jsx)(d.u,{width:"100%",height:200,children:(0,l.jsxs)(m.E,{data:r,children:[(0,l.jsx)(h.W,{dataKey:"name",stroke:"hsl(var(--muted-foreground))",fontSize:12}),(0,l.jsx)(v.h,{stroke:"hsl(var(--muted-foreground))",fontSize:12}),(0,l.jsx)(j.m,{contentStyle:{backgroundColor:"hsl(var(--card))",border:"1px solid hsl(var(--border))",borderRadius:"8px"}}),(0,l.jsx)(g.y,{dataKey:"count",radius:[8,8,0,0]})]})})})]})}var p=i(64683);function b(e){var s,i,r;let{permissions:t}=e,a=[{name:"Dangerous",value:(null===(s=t.dangerous)||void 0===s?void 0:s.length)||0,fill:"#ef4444"},{name:"Normal",value:(null===(i=t.normal)||void 0===i?void 0:i.length)||0,fill:"#3b82f6"},{name:"Signature",value:(null===(r=t.signature)||void 0===r?void 0:r.length)||0,fill:"#eab308"}];return(0,l.jsxs)(n.Zp,{children:[(0,l.jsxs)(n.aR,{children:[(0,l.jsx)(n.ZB,{children:"Permission Distribution"}),t.all_count&&(0,l.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Total: ",t.all_count," permissions (",t.malware_prone_count," malware-prone)"]})]}),(0,l.jsx)(n.Wu,{children:(0,l.jsx)(d.u,{width:"100%",height:200,children:(0,l.jsxs)(c.r,{children:[(0,l.jsx)(o.F,{data:a,cx:"50%",cy:"50%",outerRadius:80,dataKey:"value",label:!0,children:a.map((e,s)=>(0,l.jsx)(u.f,{fill:e.fill},"cell-".concat(s)))}),(0,l.jsx)(j.m,{contentStyle:{backgroundColor:"hsl(var(--card))",border:"1px solid hsl(var(--border))",borderRadius:"8px"}}),(0,l.jsx)(p.s,{})]})})})]})}var N=i(88145),y=i(1243);function w(e){let{vulnerabilities:s}=e,i=e=>{switch(e){case"critical":return"bg-red-500/10 text-red-500 border-red-500/20";case"high":return"bg-orange-500/10 text-orange-500 border-orange-500/20";case"medium":return"bg-yellow-500/10 text-yellow-500 border-yellow-500/20";case"low":return"bg-green-500/10 text-green-500 border-green-500/20";default:return""}};return(0,l.jsxs)(n.Zp,{children:[(0,l.jsx)(n.aR,{children:(0,l.jsx)(n.ZB,{children:"Recent Vulnerabilities"})}),(0,l.jsx)(n.Wu,{children:(0,l.jsx)("div",{className:"space-y-4",children:s.slice(0,4).map(e=>(0,l.jsxs)("div",{className:"flex items-start gap-4 rounded-lg border border-border p-4",children:[(0,l.jsx)("div",{className:"rounded-lg bg-destructive/10 p-2",children:(0,l.jsx)(y.A,{className:"h-5 w-5 text-destructive"})}),(0,l.jsxs)("div",{className:"flex-1 space-y-1",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("h4",{className:"font-semibold",children:e.title}),(0,l.jsx)(N.E,{variant:"outline",className:i(e.severity),children:e.severity})]}),(0,l.jsx)("p",{className:"text-sm text-muted-foreground",children:e.description}),(0,l.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Component: ",e.affectedComponent]})]})]},e.id))})})]})}var k=i(6294),R=i(32919),C=i(94498),P=i(37108),S=i(75525),_=i(40646);function A(){var e,s,i,n,t,d,c,o;let{selectedApp:u}=(0,k.n)();if(!u)return(0,l.jsx)(r.N,{children:(0,l.jsx)("div",{className:"flex h-full items-center justify-center",children:(0,l.jsx)("p",{className:"text-muted-foreground",children:"No app selected"})})});let m=u.permissions.all_count||((null===(e=u.permissions.dangerous)||void 0===e?void 0:e.length)||0)+((null===(s=u.permissions.normal)||void 0===s?void 0:s.length)||0)+((null===(i=u.permissions.signature)||void 0===i?void 0:i.length)||0),h=((null===(n=u.components.activities)||void 0===n?void 0:n.length)||0)+((null===(t=u.components.services)||void 0===t?void 0:t.length)||0)+((null===(d=u.components.receivers)||void 0===d?void 0:d.length)||0)+((null===(c=u.components.providers)||void 0===c?void 0:c.length)||0),v=[...u.components.activities||[],...u.components.services||[],...u.components.receivers||[],...u.components.providers||[]].filter(e=>e.exported).length;return(0,l.jsx)(r.N,{children:(0,l.jsxs)("div",{className:"space-y-6",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{className:"text-3xl font-bold",children:"Overview"}),(0,l.jsx)("p",{className:"text-muted-foreground",children:"Comprehensive security analysis and app insights"})]}),(0,l.jsxs)("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-4",children:[(0,l.jsx)(a,{title:"Total Permissions",value:m,icon:R.A,trend:{value:12,isPositive:!1}}),(0,l.jsx)(a,{title:"Components",value:h,icon:C.A,trend:{value:5,isPositive:!0}}),(0,l.jsx)(a,{title:"Dependencies",value:(null===(o=u.dependencies)||void 0===o?void 0:o.length)||0,icon:P.A,trend:{value:8,isPositive:!0}}),(0,l.jsx)(a,{title:"Vulnerabilities",value:u.security.vulnerabilities.length,icon:y.A,trend:{value:25,isPositive:!1}})]}),(0,l.jsxs)("div",{className:"grid gap-6 lg:grid-cols-2",children:[(0,l.jsx)(x,{score:u.security.riskScore}),(0,l.jsx)(f,{vulnerabilities:u.security.vulnerabilities})]}),(0,l.jsxs)("div",{className:"grid gap-6 lg:grid-cols-2",children:[(0,l.jsx)(b,{permissions:u.permissions}),(0,l.jsxs)("div",{className:"space-y-6",children:[(0,l.jsx)(a,{title:"Exported Components",value:v,icon:S.A,className:"bg-orange-500/5 border-orange-500/20"}),(0,l.jsx)(a,{title:"Network Security",value:u.security.networkSecurity.certificatePinning?"Enabled":"Disabled",icon:_.A,className:"bg-green-500/5 border-green-500/20"})]})]}),(0,l.jsx)(w,{vulnerabilities:u.security.vulnerabilities})]})})}},99936:(e,s,i)=>{Promise.resolve().then(i.bind(i,19650))}},e=>{var s=s=>e(e.s=s);e.O(0,[568,880,951,441,684,358],()=>s(99936)),_N_E=e.O()}]);